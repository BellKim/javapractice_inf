package java1010_jdbc_gui;
//회원정보관리.

import javax.swing.JFrame;
import javax.swing.JOptionPane;

import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.util.StringTokenizer;

public class PersonInfo extends JFrame implements ActionListener, MouseListener{
	PersonMain main;
	PersonToolbar tool;
	PersonMenu menu;
	int crow = -1;//crow 를 -1로 하지않으면 기본0이다. 인덱스번호가 0부터 시작되는데 0번인덱스가 선택되어있는것으로 인식되므로??? 뭔소리여
		
	
	public PersonInfo() {
		this.setTitle(" 개인정보관리 ");//최상단타이틀.
		
		menu = new PersonMenu();
		setJMenuBar(menu);
		
		main=new PersonMain();//객체생성후
		tool=new PersonToolbar();
		
		add(BorderLayout.CENTER, main);//센터에 연결함. 
		add(BorderLayout.NORTH,tool);//다음엔 툴바를 붙힘. 
		
		main.registerB.addActionListener(this);
		main.modifyB.addActionListener(this);
		main.deleteB.addActionListener(this);
		main.clearB.addActionListener(this);
		
		main.table.addMouseListener(this);
		
		
		
		
		
		this.setSize(520, 550);
		this.setVisible(true);
		this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		
		
	}//end personinfo() ///////////////////////////////////

	public static void main(String[] args) {
		new PersonInfo();
	}//end main

	@Override
	public void actionPerformed(ActionEvent e) {//implements ActionListener 추가해주면 personinfo 에 나타난다.
		Object obj = e.getSource();
		if(obj == main.registerB)
			setRegister();//[등록]
		
		else if(obj == main.modifyB)
			setModify();	//[수정]

	}//end actionPerformed()

	private void setModify() {
		// TODO Auto-generated method stub
		
	}

	private void setRegister() {
		String name = main.nameF.getText().trim();//trim 공백제거
		String sex = main.manR.isSelected()?"남":"여"; //메소드명이 is와 had면 결과값이 논리값이다.
//		String tel1= main.telC.getSelectedItem().toString();//두가지 방법이다.
		String tel1= (String)main.telC.getSelectedItem();
		String tel2=main.tel1F.getText().trim();
		String tel3=main.tel2F.getText().trim();
		String email=main.emailF.getText().trim();
		
		/*//1행에 고정으로 데이터가 입력되는형태. 반복문의형태로 다음행에 들어가도록 해줘야한다.
		main.table.setValueAt(Integer.toString(1), 0, 0);
		main.table.setValueAt(name, 0, 1);
		main.table.setValueAt(sex, 0, 2);
		main.table.setValueAt(tel1 + "-" + tel2 + "-" + tel3, 0, 3);
		main.table.setValueAt(email, 0, 4);*/
		
/*		for(int i=0; i<main.table.getRowCount(); i++) {
			main.table.setValueAt(Integer.toString(1), i, 0);
			main.table.setValueAt(name, i, 1);
			main.table.setValueAt(sex, i, 2);
			main.table.setValueAt(tel1 + "-" + tel2 + "-" + tel3, i, 3);
			main.table.setValueAt(email, i, 4);
		}// end for
*/		
		for(int i=0; i<main.table.getRowCount(); i++) {
			if(main.table.getValueAt(i, 0)==null) {
				main.table.setValueAt(Integer.toString(1+i), i, 0);
				main.table.setValueAt(name, i, 1);
				main.table.setValueAt(sex, i, 2);
				main.table.setValueAt(tel1 + "-" + tel2 + "-" + tel3, i, 3);
				main.table.setValueAt(email, i, 4);
				break;
			}
		}// end for
		setClear();
	}//end setRegister() ?////////////////////////////
	
	//입력된 항목 초기화 해줌. 
	public void setClear() {
		main.nameF.setText("");
		main.tel1F.setText("");
		main.tel2F.setText("");
		main.emailF.setText("");
		main.telC.setSelectedIndex(0);
		main.manR.setSelected(true);
		//커서위치
		main.nameF.requestFocus();
	}//end setClear()//////////////////////////////////
	
	private void setInputRecord() {
		int row = main.table.getSelectedRow();//수정버튼을 눌렀을때
		crow = row;//처리를한다. 
		
		
		//더블클릭한 레코드의 행값을 얻는다.
		main.nameF.setText(main.table.getValueAt(row, 1).toString());
		String sex = main.table.getValueAt(row, 2).toString();
		if(sex.equals("남"))
			main.manR.setSelected(true);
		else
			main.womanR.setSelected(true);
		String tel1 = main.table.getValueAt(row, 3).toString();
		StringTokenizer st = new StringTokenizer(tel1, "-");
		main.telC.setSelectedItem(st.nextToken());
		main.tel1F.setText(st.nextToken());
		main.tel2F.setText(st.nextToken());
		main.emailF.setText(main.table.getValueAt(row, 4).toString());
		
		
		
	}//end setInputRecord()/////////////////////////
	
	@Override
	public void mouseClicked(MouseEvent e) {// main.table.addMouseListener(this);를 작성하고온다.
		Object obj = e.getSource();
		if(obj==main.table && e.getClickCount()==2) {
			setInputRecord();
			
		}
		
	}

	@Override
	public void mouseEntered(MouseEvent e) {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void mouseExited(MouseEvent e) {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void mousePressed(MouseEvent e) {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void mouseReleased(MouseEvent e) {
		// TODO Auto-generated method stub
		
	}
	
	
	
	
	
	
}//end class 
